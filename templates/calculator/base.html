<!-- templates/calculator/base.html -->
<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{% block title %}محاسبگر پرینت سه‌بعدی{% endblock %}</title>
    
    {% load static %}
    
    <!-- Local Bootstrap 5 RTL -->
    <link href="{% static 'css/bootstrap.rtl.min.css' %}" rel="stylesheet">
    <!-- Local Font Awesome -->
    <link href="{% static 'css/fontawesome.min.css' %}" rel="stylesheet">
    <!-- Local Vazir Font -->
    <link href="{% static 'css/vazirmatn-local.css' %}" rel="stylesheet">
    
    <style>
        :root {
            /* Modern Color System */
            --primary-50: #f0f9ff;
            --primary-100: #e0f2fe;
            --primary-200: #bae6fd;
            --primary-300: #7dd3fc;
            --primary-400: #38bdf8;
            --primary-500: #0ea5e9;
            --primary-600: #0284c7;
            --primary-700: #0369a1;
            --primary-800: #075985;
            --primary-900: #0c4a6e;

            --secondary-50: #fafafa;
            --secondary-100: #f4f4f5;
            --secondary-200: #e4e4e7;
            --secondary-300: #d4d4d8;
            --secondary-400: #a1a1aa;
            --secondary-500: #71717a;
            --secondary-600: #52525b;
            --secondary-700: #3f3f46;
            --secondary-800: #27272a;
            --secondary-900: #18181b;

            --success-50: #f0fdf4;
            --success-100: #dcfce7;
            --success-200: #bbf7d0;
            --success-300: #86efac;
            --success-400: #4ade80;
            --success-500: #22c55e;
            --success-600: #16a34a;
            --success-700: #15803d;
            --success-800: #166534;
            --success-900: #14532d;

            --warning-50: #fffbeb;
            --warning-100: #fef3c7;
            --warning-200: #fde68a;
            --warning-300: #fcd34d;
            --warning-400: #fbbf24;
            --warning-500: #f59e0b;
            --warning-600: #d97706;
            --warning-700: #b45309;
            --warning-800: #92400e;
            --warning-900: #78350f;

            --danger-50: #fef2f2;
            --danger-100: #fee2e2;
            --danger-200: #fecaca;
            --danger-300: #fca5a5;
            --danger-400: #f87171;
            --danger-500: #ef4444;
            --danger-600: #dc2626;
            --danger-700: #b91c1c;
            --danger-800: #991b1b;
            --danger-900: #7f1d1d;

            --info-50: #eff6ff;
            --info-100: #dbeafe;
            --info-200: #bfdbfe;
            --info-300: #93c5fd;
            --info-400: #60a5fa;
            --info-500: #3b82f6;
            --info-600: #2563eb;
            --info-700: #1d4ed8;
            --info-800: #1e40af;
            --info-900: #1e3a8a;

            /* Surface Colors */
            --surface-50: #fefefe;
            --surface-100: #fdfdfd;
            --surface-200: #fafafa;
            --surface-300: #f7f7f7;
            --surface-400: #f3f3f3;
            --surface-500: #ededed;

            /* Glass Effect */
            --glass-bg: rgba(255, 255, 255, 0.25);
            --glass-border: rgba(255, 255, 255, 0.18);
            --glass-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.37);

            /* Telegram Colors */
            --telegram-blue: #0088cc;
            --telegram-blue-dark: #006699;
            --telegram-blue-light: #229ed9;

            /* Shadows */
            --shadow-xs: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-sm: 0 1px 3px 0 rgba(0, 0, 0, 0.1), 0 1px 2px 0 rgba(0, 0, 0, 0.06);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --shadow-2xl: 0 25px 50px -12px rgba(0, 0, 0, 0.25);

            /* Borders */
            --border-radius-sm: 6px;
            --border-radius-md: 8px;
            --border-radius-lg: 12px;
            --border-radius-xl: 16px;
            --border-radius-2xl: 24px;

            /* Spacing System */
            --spacing-xs: 0.25rem;
            --spacing-sm: 0.5rem;
            --spacing-md: 1rem;
            --spacing-lg: 1.5rem;
            --spacing-xl: 2rem;
            --spacing-2xl: 3rem;
        }

        /* Local Font Awesome CSS */
        @font-face {
            font-family: "Font Awesome 6 Free";
            src: url("{% static 'fonts/fontawesome/fa-solid-900.woff2' %}") format("woff2");
            font-weight: 900;
            font-style: normal;
            font-display: swap;
        }
        
        @font-face {
            font-family: "Font Awesome 6 Free";
            src: url("{% static 'fonts/fontawesome/fa-regular-400.woff2' %}") format("woff2");
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }
        
        @font-face {
            font-family: "Font Awesome 6 Brands";
            src: url("{% static 'fonts/fontawesome/fa-brands-400.woff2' %}") format("woff2");
            font-weight: 400;
            font-style: normal;
            font-display: swap;
        }

        .fa, .fas {
            font-family: "Font Awesome 6 Free";
            font-weight: 900;
        }

        .far {
            font-family: "Font Awesome 6 Free";
            font-weight: 400;
        }

        .fab {
            font-family: "Font Awesome 6 Brands";
            font-weight: 400;
        }

        * {
            font-family: 'Vazirmatn', 'Tahoma', 'Arial', sans-serif;
            box-sizing: border-box;
        }

        body {
            background: linear-gradient(135deg, var(--primary-50) 0%, var(--surface-100) 100%);
            min-height: 100vh;
            color: var(--secondary-800);
            line-height: 1.6;
            font-weight: 400;
        }

        /* Navigation */
        .navbar {
            background: rgba(255, 255, 255, 0.95) !important;
            backdrop-filter: blur(20px);
            border-bottom: 1px solid var(--primary-200);
            box-shadow: var(--shadow-sm);
            padding: var(--spacing-md) 0;
        }

        .navbar-brand {
            font-weight: 800;
            font-size: 1.5rem;
            color: var(--primary-700) !important;
            text-decoration: none;
        }

        .navbar-nav .nav-link {
            font-weight: 500;
            margin: 0 var(--spacing-xs);
            padding: var(--spacing-sm) var(--spacing-md) !important;
            border-radius: var(--border-radius-md);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            color: var(--secondary-600) !important;
            position: relative;
            overflow: hidden;
        }

        .navbar-nav .nav-link:hover {
            background: var(--primary-50);
            color: var(--primary-700) !important;
            transform: translateY(-1px);
        }

        .navbar-nav .nav-link.active {
            background: var(--primary-100);
            color: var(--primary-700) !important;
        }

        /* Support Link in Navbar */
        .support-link {
            background: linear-gradient(135deg, var(--telegram-blue), var(--telegram-blue-light)) !important;
            color: white !important;
            border-radius: var(--border-radius-md);
            margin-right: var(--spacing-sm);
            transition: all 0.3s ease;
        }

        .support-link:hover {
            background: linear-gradient(135deg, var(--telegram-blue-light), var(--telegram-blue)) !important;
            color: white !important;
            transform: translateY(-1px);
            box-shadow: 0 4px 12px rgba(0, 136, 204, 0.4);
        }

        .support-link i {
            color: white;
        }

        /* Cards */
        .card {
            background: rgba(255, 255, 255, 0.7);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-xl);
            box-shadow: var(--shadow-lg);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: var(--shadow-2xl);
            border-color: var(--primary-200);
        }

        .card-header {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
            color: white;
            border: none;
            border-radius: var(--border-radius-xl) var(--border-radius-xl) 0 0 !important;
            padding: var(--spacing-lg);
            font-weight: 600;
            position: relative;
            overflow: hidden;
        }

        .card-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(135deg, transparent, rgba(255, 255, 255, 0.1));
            pointer-events: none;
        }

        .card-body {
            padding: var(--spacing-xl);
        }

        /* Modern Button System */
        .btn {
            font-weight: 600;
            padding: var(--spacing-sm) var(--spacing-lg);
            border-radius: var(--border-radius-md);
            border: none;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            box-shadow: var(--shadow-sm);
            position: relative;
            overflow: hidden;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            justify-content: center;
            gap: var(--spacing-xs);
        }

        .btn::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
            transition: left 0.5s;
        }

        .btn:hover::before {
            left: 100%;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .btn:active {
            transform: translateY(0);
        }

        /* Primary Button */
        .btn-primary {
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
            color: white;
            box-shadow: 0 4px 14px 0 rgba(14, 165, 233, 0.39);
        }

        .btn-primary:hover {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
            color: white;
            box-shadow: 0 6px 20px 0 rgba(14, 165, 233, 0.5);
        }

        /* Success Button */
        .btn-success {
            background: linear-gradient(135deg, var(--success-500), var(--success-600));
            color: white;
            box-shadow: 0 4px 14px 0 rgba(34, 197, 94, 0.39);
        }

        .btn-success:hover {
            background: linear-gradient(135deg, var(--success-600), var(--success-700));
            color: white;
            box-shadow: 0 6px 20px 0 rgba(34, 197, 94, 0.5);
        }

        /* Warning Button */
        .btn-warning {
            background: linear-gradient(135deg, var(--warning-500), var(--warning-600));
            color: white;
            box-shadow: 0 4px 14px 0 rgba(245, 158, 11, 0.39);
        }

        .btn-warning:hover {
            background: linear-gradient(135deg, var(--warning-600), var(--warning-700));
            color: white;
            box-shadow: 0 6px 20px 0 rgba(245, 158, 11, 0.5);
        }

        /* Danger Button */
        .btn-danger {
            background: linear-gradient(135deg, var(--danger-500), var(--danger-600));
            color: white;
            box-shadow: 0 4px 14px 0 rgba(239, 68, 68, 0.39);
        }

        .btn-danger:hover {
            background: linear-gradient(135deg, var(--danger-600), var(--danger-700));
            color: white;
            box-shadow: 0 6px 20px 0 rgba(239, 68, 68, 0.5);
        }

        /* Info Button */
        .btn-info {
            background: linear-gradient(135deg, var(--info-500), var(--info-600));
            color: white;
            box-shadow: 0 4px 14px 0 rgba(59, 130, 246, 0.39);
        }

        .btn-info:hover {
            background: linear-gradient(135deg, var(--info-600), var(--info-700));
            color: white;
            box-shadow: 0 6px 20px 0 rgba(59, 130, 246, 0.5);
        }

        /* Outline Buttons */
        .btn-outline-primary {
            background: transparent;
            color: var(--primary-600);
            border: 2px solid var(--primary-500);
            box-shadow: none;
        }

        .btn-outline-primary:hover {
            background: var(--primary-500);
            color: white;
            border-color: var(--primary-500);
        }

        .btn-outline-secondary {
            background: transparent;
            color: var(--secondary-600);
            border: 2px solid var(--secondary-400);
            box-shadow: none;
        }

        .btn-outline-secondary:hover {
            background: var(--secondary-500);
            color: white;
            border-color: var(--secondary-500);
        }

        .btn-outline-danger {
            background: transparent;
            color: var(--danger-600);
            border: 2px solid var(--danger-500);
            box-shadow: none;
        }

        .btn-outline-danger:hover {
            background: var(--danger-500);
            color: white;
            border-color: var(--danger-500);
        }

        /* Button Sizes */
        .btn-sm {
            padding: var(--spacing-xs) var(--spacing-md);
            font-size: 0.875rem;
        }

        .btn-lg {
            padding: var(--spacing-md) var(--spacing-xl);
            font-size: 1.125rem;
            border-radius: var(--border-radius-lg);
        }

        /* Badge System */
        .badge {
            padding: var(--spacing-xs) var(--spacing-sm);
            border-radius: var(--border-radius-sm);
            font-weight: 600;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.025em;
        }

        .bg-primary { background: var(--primary-500) !important; }
        .bg-success { background: var(--success-500) !important; }
        .bg-warning { background: var(--warning-500) !important; }
        .bg-danger { background: var(--danger-500) !important; }
        .bg-info { background: var(--info-500) !important; }
        .bg-secondary { background: var(--secondary-500) !important; }

        /* Table Styling */
        .table {
            background: rgba(255, 255, 255, 0.8);
            border-radius: var(--border-radius-lg);
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .table thead th {
            background: linear-gradient(135deg, var(--secondary-700), var(--secondary-800));
            color: white;
            border: none;
            font-weight: 600;
            padding: var(--spacing-lg);
            text-transform: uppercase;
            letter-spacing: 0.025em;
            font-size: 0.875rem;
        }

        .table tbody tr {
            transition: all 0.3s ease;
            border-bottom: 1px solid var(--secondary-200);
        }

        .table tbody tr:hover {
            background: var(--primary-50);
            transform: scale(1.01);
        }

        .table tbody td {
            padding: var(--spacing-md);
            vertical-align: middle;
        }

        /* Form Controls */
        .form-control, .form-select {
            border: 2px solid var(--secondary-200);
            border-radius: var(--border-radius-md);
            padding: var(--spacing-sm) var(--spacing-md);
            transition: all 0.3s ease;
            background: rgba(255, 255, 255, 0.8);
            backdrop-filter: blur(10px);
            font-weight: 500;
        }

        .form-control:focus, .form-select:focus {
            border-color: var(--primary-500);
            box-shadow: 0 0 0 3px rgba(14, 165, 233, 0.1);
            transform: translateY(-1px);
            background: white;
        }

        .form-label {
            font-weight: 600;
            color: var(--secondary-700);
            margin-bottom: var(--spacing-sm);
        }

        /* Alert System */
        .alert {
            border: none;
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-lg);
            font-weight: 500;
            border-left: 4px solid;
        }

        .alert-success {
            background: linear-gradient(135deg, var(--success-50), var(--success-100));
            color: var(--success-800);
            border-left-color: var(--success-500);
        }

        .alert-danger, .alert-error {
            background: linear-gradient(135deg, var(--danger-50), var(--danger-100));
            color: var(--danger-800);
            border-left-color: var(--danger-500);
        }

        .alert-warning {
            background: linear-gradient(135deg, var(--warning-50), var(--warning-100));
            color: var(--warning-800);
            border-left-color: var(--warning-500);
        }

        .alert-info {
            background: linear-gradient(135deg, var(--info-50), var(--info-100));
            color: var(--info-800);
            border-left-color: var(--info-500);
        }

        /* Stats Cards */
        .stats-card {
            background: linear-gradient(135deg, var(--surface-50), rgba(255, 255, 255, 0.8));
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: var(--border-radius-xl);
            padding: var(--spacing-xl);
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
            overflow: hidden;
        }

        .stats-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 4px;
            background: linear-gradient(90deg, var(--primary-500), var(--primary-600), var(--success-500));
        }

        .stats-card:hover {
            transform: translateY(-8px) scale(1.02);
            box-shadow: var(--shadow-2xl);
        }

        .stats-icon {
            font-size: 3rem;
            margin-bottom: var(--spacing-md);
            color: var(--primary-500);
            opacity: 0.8;
        }

        .stats-number {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: var(--spacing-sm);
            color: var(--secondary-800);
        }

        .stats-label {
            font-size: 1rem;
            color: var(--secondary-600);
            font-weight: 500;
        }

        /* Page Header */
        .page-header {
            background: linear-gradient(135deg, var(--primary-600), var(--primary-700));
            color: white;
            padding: var(--spacing-2xl) 0;
            margin-bottom: var(--spacing-xl);
            border-radius: 0 0 var(--border-radius-2xl) var(--border-radius-2xl);
            position: relative;
            overflow: hidden;
        }

        .page-header::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
            opacity: 0.5;
        }

        .page-title {
            font-size: 2.5rem;
            font-weight: 800;
            margin-bottom: var(--spacing-sm);
            position: relative;
        }

        .page-subtitle {
            font-size: 1.125rem;
            opacity: 0.9;
            font-weight: 400;
            position: relative;
        }

        /* Cost Preview */
        .cost-preview {
            background: linear-gradient(135deg, var(--primary-50), var(--surface-100));
            border: 1px solid var(--primary-200);
            border-radius: var(--border-radius-lg);
            padding: var(--spacing-lg);
            margin: var(--spacing-md) 0;
        }

        .cost-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: var(--spacing-sm) 0;
            border-bottom: 1px solid var(--primary-200);
            font-weight: 500;
        }

        .cost-item:last-child {
            border-bottom: none;
            margin-bottom: 0;
            padding-bottom: 0;
        }

        /* Floating Action Button */
        .floating-action {
            position: fixed;
            bottom: var(--spacing-xl);
            left: var(--spacing-xl);
            z-index: 1000;
        }

        .floating-action .btn {
            width: 60px;
            height: 60px;
            border-radius: 50%;
            box-shadow: var(--shadow-xl);
            background: linear-gradient(135deg, var(--primary-500), var(--primary-600));
        }

        /* Floating Support Button */
        .telegram-support {
            position: fixed;
            bottom: 30px;
            left: 30px;
            z-index: 9999;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, var(--telegram-blue), var(--telegram-blue-light));
            color: white;
            border-radius: 50%;
            text-decoration: none;
            font-size: 24px;
            box-shadow: 0 4px 20px rgba(0, 136, 204, 0.4);
            transition: all 0.3s ease;
            animation: telegram-pulse 3s infinite;
        }

        .telegram-support:hover {
            background: linear-gradient(135deg, var(--telegram-blue-light), var(--telegram-blue));
            color: white;
            transform: translateY(-3px) scale(1.1);
            box-shadow: 0 8px 25px rgba(0, 136, 204, 0.6);
            text-decoration: none;
            animation: none;
        }

        .telegram-support:active {
            transform: translateY(-1px) scale(1.05);
        }

        @keyframes telegram-pulse {
            0% {
                box-shadow: 0 4px 20px rgba(0, 136, 204, 0.4);
            }
            50% {
                box-shadow: 0 4px 20px rgba(0, 136, 204, 0.6), 0 0 0 10px rgba(0, 136, 204, 0.1);
            }
            100% {
                box-shadow: 0 4px 20px rgba(0, 136, 204, 0.4);
            }
        }

        /* Animations */
        .fade-in {
            animation: fadeInUp 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        .slide-in-right {
            animation: slideInRight 0.8s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @keyframes fadeInUp {
            from { 
                opacity: 0; 
                transform: translateY(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateY(0); 
            }
        }

        @keyframes slideInRight {
            from { 
                opacity: 0; 
                transform: translateX(30px); 
            }
            to { 
                opacity: 1; 
                transform: translateX(0); 
            }
        }

        /* Loading Animation */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid rgba(255,255,255,.3);
            border-radius: 50%;
            border-top-color: #fff;
            animation: spin 1s ease-in-out infinite;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--secondary-100);
            border-radius: var(--border-radius-md);
        }

        ::-webkit-scrollbar-thumb {
            background: var(--primary-400);
            border-radius: var(--border-radius-md);
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-500);
        }

        /* Responsive Design */
        @media (max-width: 768px) {
            .card {
                margin-bottom: var(--spacing-md);
            }
            
            .page-title {
                font-size: 2rem;
            }
            
            .stats-card {
                margin-bottom: var(--spacing-md);
            }
            
            .navbar-nav .nav-link {
                margin: var(--spacing-xs) 0;
            }

            /* Hide floating button on small screens */
            .telegram-support {
                display: none !important;
            }
        }

        /* Utility Classes */
        .text-primary { color: var(--primary-600) !important; }
        .text-secondary { color: var(--secondary-600) !important; }
        .text-success { color: var(--success-600) !important; }
        .text-warning { color: var(--warning-600) !important; }
        .text-danger { color: var(--danger-600) !important; }
        .text-info { color: var(--info-600) !important; }

        .bg-light { background: var(--surface-100) !important; }

        /* Dropdown */
        .dropdown-menu {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid var(--secondary-200);
            border-radius: var(--border-radius-lg);
            box-shadow: var(--shadow-xl);
            padding: var(--spacing-sm);
        }

        .dropdown-item {
            border-radius: var(--border-radius-sm);
            padding: var(--spacing-sm) var(--spacing-md);
            font-weight: 500;
            transition: all 0.2s ease;
        }

        .dropdown-item:hover {
            background: var(--primary-50);
            color: var(--primary-700);
        }

        /* Project Image Styling */
        .project-image {
            border-radius: var(--border-radius-md);
            transition: transform 0.3s ease;
        }

        .project-image:hover {
            transform: scale(1.05);
        }

        .image-placeholder {
            background: linear-gradient(135deg, var(--surface-200), var(--surface-300));
            border: 2px dashed var(--primary-300);
            border-radius: var(--border-radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--primary-500);
        }

        .navbar .dropdown-menu {
            z-index: 9999 !important;
            position: absolute !important;
        }

        .navbar {
            z-index: 1030 !important;
        }

        .dropdown-menu.show {
            z-index: 9999 !important;
        }

        .navbar-nav .dropdown-menu {
            z-index: 9999 !important;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15) !important;
            border: 1px solid rgba(0, 0, 0, 0.1) !important;
        }

        /* Telegram Icon Color Override */
        .fab.fa-telegram {
            color: inherit;
        }

        /* Navbar toggler styling */
        .navbar-toggler {
            border: none;
            box-shadow: none;
            padding: 0.25rem 0.5rem;
        }

        .navbar-toggler:focus {
            box-shadow: none;
        }

        .navbar-toggler-icon {
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%2833, 37, 41, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar navbar-expand-lg">
        <div class="container">
            <a class="navbar-brand" href="{% url 'calculator:index' %}">
                <i class="fas fa-cube me-2"></i>
                محاسبگر پرینت سه‌بعدی
            </a>
            
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav" style="border: none; box-shadow: none;">
                <span class="navbar-toggler-icon"></span>
            </button>
            
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav me-auto">
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'calculator:index' %}">
                            <i class="fas fa-home me-1"></i>
                            داشبورد
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'calculator:add_filament' %}">
                            <i class="fas fa-plus-circle me-1"></i>
                            فیلامنت جدید
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'calculator:pricing_settings' %}">
                            <i class="fas fa-sliders-h me-1"></i> تنظیمات
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'calculator:projects' %}">
                            <i class="fas fa-project-diagram me-1"></i>
                            مدل ها
                        </a>
                    </li>
                    <li class="nav-item dropdown">
                        <a class="nav-link dropdown-toggle" href="#" id="salesDropdown" role="button" data-bs-toggle="dropdown">
                            <i class="fas fa-shopping-cart me-1"></i>
                            فروش
                        </a>
                        <ul class="dropdown-menu">
                            <li><a class="dropdown-item" href="{% url 'calculator:sales' %}">
                                <i class="fas fa-plus me-2"></i>فروش جدید
                            </a></li>
                            <li><a class="dropdown-item" href="{% url 'calculator:sales_history' %}">
                                <i class="fas fa-history me-2"></i>تاریخچه فروش
                            </a></li>
                        </ul>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'calculator:reports' %}">
                            <i class="fas fa-chart-bar me-1"></i>
                            گزارش‌ها
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="{% url 'license_page' %}">
                            <i class="fas fa-key me-1"></i>
                            لایسنس
                        </a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="https://t.me/threedbynaser" target="_blank" rel="noopener noreferrer">
                            <i class="fab fa-telegram me-1"></i>
                            پشتیبانی
                        </a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Floating Telegram Support Button -->
    <a href="https://t.me/threedbynaser" target="_blank" rel="noopener noreferrer" class="telegram-support" title="پشتیبانی تلگرام">
        <i class="fab fa-telegram"></i>
    </a>

    <!-- Flash Messages -->
    {% if messages %}
        <div class="container mt-3">
            {% for message in messages %}
                <div class="alert alert-{{ message.tags }} alert-dismissible fade show" role="alert">
                    {% if message.tags == 'error' %}
                        <i class="fas fa-exclamation-triangle me-2"></i>
                    {% elif message.tags == 'success' %}
                        <i class="fas fa-check-circle me-2"></i>
                    {% elif message.tags == 'warning' %}
                        <i class="fas fa-exclamation-circle me-2"></i>
                    {% else %}
                        <i class="fas fa-info-circle me-2"></i>
                    {% endif %}
                    {{ message }}
                    <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
                </div>
            {% endfor %}
        </div>
    {% endif %}

    <!-- Main Content -->
    <main class="container-fluid py-4">
        {% block content %}{% endblock %}
    </main>

    <!-- Scripts -->
    <script src="{% static 'js/bootstrap.bundle.min.js' %}"></script>
    <script>
        // Enhanced loading animation for buttons
        document.querySelectorAll('form').forEach(form => {
            form.addEventListener('submit', function(e) {
                const submitBtn = form.querySelector('button[type="submit"]');
                if (submitBtn && !submitBtn.disabled) {
                    const originalText = submitBtn.innerHTML;
                    submitBtn.innerHTML = '<span class="loading me-2"></span> در حال پردازش...';
                    submitBtn.disabled = true;
                    
                    // Re-enable button after 5 seconds (safety measure)
                    setTimeout(() => {
                        submitBtn.innerHTML = originalText;
                        submitBtn.disabled = false;
                    }, 5000);
                }
            });
        });

        // Enhanced auto-hide alerts
        setTimeout(() => {
            document.querySelectorAll('.alert').forEach(alert => {
                if (alert.classList.contains('show')) {
                    alert.style.transition = 'all 0.3s ease';
                    alert.style.opacity = '0';
                    alert.style.transform = 'translateY(-10px)';
                    setTimeout(() => alert.remove(), 300);
                }
            });
        }, 5000);

        // Add smooth scroll behavior
        document.documentElement.style.scrollBehavior = 'smooth';

        // Enhanced card hover effects
        document.addEventListener('DOMContentLoaded', function() {
            // Add stagger animation to cards
            const cards = document.querySelectorAll('.card');
            cards.forEach((card, index) => {
                card.style.animationDelay = `${index * 0.1}s`;
            });

            // Add active class to current nav item
            const currentPath = window.location.pathname;
            const navLinks = document.querySelectorAll('.navbar-nav .nav-link');
            
            navLinks.forEach(link => {
                if (link.getAttribute('href') === currentPath) {
                    link.classList.add('active');
                }
            });

            // Enhanced floating button interaction
            const supportBtn = document.querySelector('.telegram-support');
            if (supportBtn) {
                supportBtn.addEventListener('click', function() {
                    // Add a quick success animation
                    this.style.transform = 'scale(0.95)';
                    setTimeout(() => {
                        this.style.transform = '';
                    }, 150);
                });
            }
        });
    </script>
    
    {% block scripts %}{% endblock %}
</body>
</html>